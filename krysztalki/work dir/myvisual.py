from mpl_toolkits.mplot3d import Axes3D  
import matplotlib.pyplot as plt
import numpy as np

def make_plot(CELL,title=None):
  fig = plt.figure()
  ax = fig.add_subplot(111, projection='3d')

  #for c, m in [('r', 'o'), ('b', '^')]:
#   var = np.unique(np.argwhere((CELL==1)|(CELL==-1))[:,0])
#   l1 = CELL[var]
#   xs, ys, zs = l1.T
#   ax.scatter(xs, ys, zs, c="r", marker="^")

  mojalista2 = CELL
#   mojalista2  = np.delete(mojalista2, var, 0)
  xs, ys, zs = mojalista2.T
  ax.scatter(xs, ys, zs, c="b", marker="^")

  ax.set_xlabel('X Label')
  ax.set_ylabel('Y Label')
  ax.set_zlabel('Z Label')
  
  plt.title(title)

  plt.show()

if __name__ == '__main__':
  from cifParsing import *

  TESTCELL = np.unique([[-1. , -1. , -1. ], [-1. ,  0. ,  0. ], [-1. ,  1. , -1. ], [-1. , -1. ,  1. ], [-1. ,  1. ,  1. ], [-0.5, -0.5, -0.5], [-0.5,  0.5,  0.5], [ 0. , -1. ,  0. ], [ 1. , -1. , -1. ], [ 0. ,  0. , -1. ], [ 0. ,  1. ,  0. ], [ 0.5, -0.5,  0.5], [ 0.5,  0.5, -0.5], [ 1. ,  0. ,  0. ], [ 1. , -1. ,  1. ], [ 0. ,  1. , 0. ], [ 1. ,  1. , -1. ], [ 1. ,  1. ,  1. ], [ 0, 0, 1]
  ],axis=0)
  
  TESTCELL2 = np.unique([[1., -1., -1.],[1., -1., 0.],[1., -1., 1.],[1., -0.5, -0.5],[1., -0.5, 0.5],[1., 0., -1.],[1., 0., 0.],[1., 0., 1.],[1., 0.5, -0.5],[1., 0.5, 0.5],[1., 1., -1.],[1., 1., 0.],[1., 1., 1.],[0.75, -0.75, -0.75],[0.75, -0.75, 0.25],[0.75, -0.25, -0.25],[0.75, 0.25, -0.75],[0.75, 0.25, 0.25],[0.75, 0.75, -0.25],[0.75, 0.75, 0.75],[0.5, -1., -0.5],[0.5, -1., 0.5],[0.5, -0.5, -1.],[0.5, -0.5, 0.],[0.5, -0.5, 1.],[0.5, 0., -0.5],[0.5, 0., 0.5],[0.5, 0.5, -1.],[0.5, 0.5, 0.],[0.5, 0.5, 1.],[0.5, 1., -0.5],[0.5, 1., 0.5],[0.25, -0.75, -0.25],[0.25, -0.75, 0.75],[0.25, -0.25, -0.75],[0.25, -0.25, 0.25],[0.25, 0.25, -0.25],[0.25, 0.25, 0.75],[0.25, 0.75, -0.75],[0.25, 0.75, 0.25],[0., -1., -1.],[0., -1., 0.],[0., -1., 1.],[0., -0.5, -0.5],[0., -0.5, 0.5],[0., 0., -1.],[0., 0., 0.],[0., 0., 1.],[0., 0.5, -0.5],[0., 0.5, 0.5],[0., 1., -1.],[0., 1., 0.],[0., 1., 1.],[-0.25, -0.75, -0.75],[-0.25, -0.75, 0.25],[-0.25, -0.25, -0.25],[-0.25, -0.25, 0.75],[-0.25, 0.25, -0.75],[-0.25, 0.25, 0.25],[-0.25, 0.75, -0.25],[-0.25, 0.75, 0.75],[-0.25, 0.75, 0.75],[-0.5, -1., -0.5],[-0.5, -1., 0.5],[-0.5, -0.5, -1.],[-0.5, -0.5, 0.],[-0.5, -0.5, 1.],[-0.5, 0., -0.5],[-0.5, 0., 0.5],[-0.5, 0.5, -1.],[-0.5, 0.5, 0.],[-0.5, 0.5, 1.],[-0.5, 1., -0.5],[-0.5, 1., 0.5],[-0.75, -0.75, -0.25],[-0.75, -0.75, 0.75],[-0.75, -0.25, -0.75],[-0.75, -0.25, 0.25],[-0.75, 0.25, -0.25],[-0.75, 0.25, 0.75],[-0.75, 0.75, -0.75],[-0.75, 0.75, 0.25],[-1., -1., -1.],[-1., -1., 0.],[-1., -1., 1.],[-1., -0.5, -0.5],[-1., -0.5, 0.5],[-1., 0., -1.],[-1., 0., 0.],[-1., 0., 1.],[-1., 0.5, -0.5],[-1., 0.5, 0.5],[-1., 1., -1.],[-1., 1., 0.],[-1., 1., 1.]]
,axis=0)

  cell, base = getSCell(Crystal.from_cif, 'ZnS-Sfaleryt.cif', size = 3)
  make_plot(cell,"myfunc")
#   make_plot(TESTCELL2,'vesta')